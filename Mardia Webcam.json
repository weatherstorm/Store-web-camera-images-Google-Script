{"files":[{"id":"38b2f00e-c9b4-4f52-b127-224dfb56298d","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"America/Boise\",\n  \"dependencies\": {\n  },\n  \"exceptionLogging\": \"STACKDRIVER\",\n  \"runtimeVersion\": \"V8\"\n}"},{"id":"f7eff781-4f97-43c4-be9a-849dc20163e8","name":"Code","type":"server_js","source":"//Grabs webcam image from the website and stores it in my Google Drive\nfunction getWebcam() {\n  var d \u003d new Date()\n  var timeStamp \u003d d.getTime()\n  var timeZone \u003d d.getTimezoneOffset()\n  var dString \u003d Utilities.formatDate(d, timeZone, \u0027yyyy-MM-dd\u0027)\n\n  var url \u003d \"https://www.centuryfarmweather.com/webcam/image.jpg\"\n\n  var response \u003d UrlFetchApp.fetch(url).getBlob()\n\n  //set file name to unix timestamp\n  response.setName(timeStamp)\n \n  var folder \u003d DriveApp.getFolderById(\"1XyO7DUh6Ty1mt27ernO0G7vtXxWQwmOQ\")\n  \n  //check if folder exists\n  var folderName \u003d dString\n  \n  // Log the name of every folder in the user\u0027s Drive that you own and is starred.\n  var folders \u003d DriveApp.getFoldersByName(folderName)\n  //Logger.log(folder)\n\n  if(folders.hasNext() \u003d\u003d false){\n    folder \u003d folder.createFolder(dString)\n    return folder.createFile(response)\n  }else{\n    folder \u003d folders.next()\n    //Logger.log(folder)\n    return folder.createFile(response)\n  }\n}\n\n//Delete 2 week old files\nfunction cleanDrive() {\n\n  var folder \u003d DriveApp.getFolderById(\"1XyO7DUh6Ty1mt27ernO0G7vtXxWQwmOQ\")\n\n  var folderNames \u003d folder.getFolders()\n\n  //timestamp for two weeks out\n  const MILLIS_PER_DAY \u003d 1000 * 60 * 60 * 24\n  const d \u003d new Date()\n  var old \u003d new Date(d.getTime() - 14 * MILLIS_PER_DAY)\n  var timeStamp \u003d old.getTime()\n  var timeZone \u003d old.getTimezoneOffset()\n  var dateString \u003d Utilities.formatDate(old, timeZone, \u0027yyyy-MM-dd\u0027)\n\n  while (folderNames.hasNext()){\n    var folders \u003d folderNames.next()\n    var fNdate \u003d new Date(folders)\n    var dSdate \u003d new Date(dateString)\n    //Logger.log(dateString)\n    //Logger.log(dSdate)\n\n    if(folders \u003c dateString){\n      folders.setTrashed(true)\n    }\n  \n  }\n\n}\n"}]}